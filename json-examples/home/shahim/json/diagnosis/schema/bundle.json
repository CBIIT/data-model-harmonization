{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "http://ccdh/json/schema/bundle",
  "$comment": "A schema bundle of all schemas, to help with using at: https://jschon.dev/ since IDEs don't give good validation results for complex schemas, or don't implement the specific version used here.",
  "$ref": "http://ccdh/json/schema/validate-diagnosis-1-coding-based-example",
  "$defs": {
    "_template": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/"
    },
    "validate-diagnosis-1-coding-based-example": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/validate-diagnosis-1-coding-based-example",
      "allOf": [
        {
          "$comment": "First we validate with the structure schema",
          "$ref": "http://ccdh/json/schema/structures#/$defs/Diagnosis"
        },
        {
          "if": {
            "properties": {
              "condition": {
                "$ref": "http://ccdh/json/schema/coding-is-stageable-condition"
              }
            }
          },
          "then": true,
          "else": false
        }
      ]
    },
    "coding-is-stageable-condition": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/coding-is-stageable-condition",
      "properties": {
        "coding": {
          "contains": {
            "properties": {
              "system": {
                "const": "http://ccdh/vs/stageable-condition"
              },
              "code": {
                "$ref": "http://ccdh/json/schema/code-is-stageable-condition"
              }
            },
            "required": [
              "system"
            ]
          }
        }
      }
    },
    "code-is-stageable-condition": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/code-is-stageable-condition",
      "$ref": "http://ccdh/json/schema/codes-stageable-condition-enum"
    },
    "codes-figo-body-site-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codes-figo-body-site-enum",
      "enum": [
        "I",
        "IA",
        "IB"
      ]
    },
    "codes-figo-2018-stage-vulval-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codes-figo-2018-stage-vulval-enum",
      "enum": [
        "I",
        "IA",
        "IB"
      ]
    },
    "codes-figo-2018-stage-vaginal-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codes-figo-2018-stage-vaginal-enum",
      "enum": [
        "0",
        "I",
        "IB1",
        "IB2",
        "IB3"
      ]
    },
    "codes-figo-pre2018-stage-cervical-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codes-figo-pre2018-stage-cervical-enum",
      "enum": [
        "0",
        "I",
        "IA",
        "IA1",
        "IA2",
        "IB"
      ]
    },
    "codes-figo-2018-stage-cervical-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codes-figo-2018-stage-cervical-enum",
      "enum": [
        "I",
        "IA",
        "IA1",
        "IA2",
        "IB"
      ]
    },
    "codes-figo-2018-stage-endometrial-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codes-figo-2018-stage-endometrial-enum",
      "enum": [
        "0",
        "I",
        "IA",
        "IB"
      ]
    },
    "codes-figo-2018-stage-ovarian-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codes-figo-2018-stage-ovarian-enum",
      "enum": [
        "I",
        "IA",
        "IB",
        "IC",
        "IC1",
        "IC2",
        "IC3"
      ]
    },
    "codes-figo-2018-stage-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codes-figo-2018-stage-enum",
      "enum": [
        "0",
        "I",
        "IA",
        "IA1",
        "IA2",
        "IB",
        "IB1",
        "IB2",
        "IB3",
        "IC",
        "IC1",
        "IC2",
        "IC3"
      ]
    },
    "codes-figo-version-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codes-figo-version-enum",
      "enum": [
        "2018",
        "pre2018"
      ]
    },
    "codes-staging-system-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codes-staging-system-enum",
      "enum": [
        "AJCC",
        "FIGO"
      ]
    },
    "codes-stageable-condition-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codes-stageable-condition-enum",
      "enum": [
        "cancer"
      ]
    },
    "codings-figo-body-site-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codings-figo-body-site-enum",
      "enum": [
        {
          "system": "http://ccdh/vs/figo-body-site",
          "code": "ovary",
          "label": "Ovary body site"
        },
        {
          "system": "http://ccdh/vs/figo-body-site",
          "code": "endometrium",
          "label": "Endometrium body site"
        },
        {
          "system": "http://ccdh/vs/figo-body-site",
          "code": "cervix",
          "label": "Cervix body site"
        },
        {
          "system": "http://ccdh/vs/figo-body-site",
          "code": "vagina",
          "label": "Vagina body site"
        },
        {
          "system": "http://ccdh/vs/figo-body-site",
          "code": "vulva",
          "label": "Vulva body site"
        }
      ]
    },
    "codings-figo-2018-stage-vulval-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codings-figo-2018-stage-vulval-enum",
      "enum": [
        {
          "system": "http://ccdh/vs/figo-2018-stage-vulval",
          "code": "I",
          "label": "Stage I"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-vulval",
          "code": "IA",
          "label": "Stage IA"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-vulval",
          "code": "IB",
          "label": "Stage IB"
        }
      ]
    },
    "codings-figo-2018-stage-vaginal-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codings-figo-2018-stage-vaginal-enum",
      "enum": [
        {
          "system": "http://ccdh/vs/figo-2018-stage-vaginal",
          "code": "0",
          "label": "Stage 0"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-vaginal",
          "code": "I",
          "label": "Stage I"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-vaginal",
          "code": "IB1",
          "label": "Stage IB1"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-vaginal",
          "code": "IB2",
          "label": "Stage IB2"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-vaginal",
          "code": "IB3",
          "label": "Stage IB3"
        }
      ]
    },
    "codings-figo-pre2018-stage-cervical-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codings-figo-pre2018-stage-cervical-enum",
      "enum": [
        {
          "system": "http://ccdh/vs/figo-pre2018-stage-cervical",
          "code": "0",
          "label": "Stage 0"
        },
        {
          "system": "http://ccdh/vs/figo-pre2018-stage-cervical",
          "code": "I",
          "label": "Stage I"
        },
        {
          "system": "http://ccdh/vs/figo-pre2018-stage-cervical",
          "code": "IA",
          "label": "Stage IA"
        },
        {
          "system": "http://ccdh/vs/figo-pre2018-stage-cervical",
          "code": "IA1",
          "label": "Stage IA1"
        },
        {
          "system": "http://ccdh/vs/figo-pre2018-stage-cervical",
          "code": "IA2",
          "label": "Stage IA2"
        },
        {
          "system": "http://ccdh/vs/figo-pre2018-stage-cervical",
          "code": "IB",
          "label": "Stage IB"
        }
      ]
    },
    "codings-figo-2018-stage-cervical-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codings-figo-2018-stage-cervical-enum",
      "enum": [
        {
          "system": "http://ccdh/vs/figo-2018-stage-cervical",
          "code": "I",
          "label": "Stage I"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-cervical",
          "code": "IA",
          "label": "Stage IA"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-cervical",
          "code": "IA1",
          "label": "Stage IA1"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-cervical",
          "code": "IA2",
          "label": "Stage IA2"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-cervical",
          "code": "IB",
          "label": "Stage IB"
        }
      ]
    },
    "codings-figo-2018-stage-endometrial-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codings-figo-2018-stage-endometrial-enum",
      "enum": [
        {
          "system": "http://ccdh/vs/figo-2018-stage-endometrial",
          "code": "0",
          "label": "Stage 0"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-endometrial",
          "code": "I",
          "label": "Stage I"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-endometrial",
          "code": "IA",
          "label": "Stage IA"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-endometrial",
          "code": "IB",
          "label": "Stage IB"
        }
      ]
    },
    "codings-figo-2018-stage-ovarian-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codings-figo-2018-stage-ovarian-enum",
      "enum": [
        {
          "system": "http://ccdh/vs/figo-2018-stage-ovarian",
          "code": "I",
          "label": "Stage I"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-ovarian",
          "code": "IA",
          "label": "Stage IA"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-ovarian",
          "code": "IB",
          "label": "Stage IB"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-ovarian",
          "code": "IC",
          "label": "Stage IC"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-ovarian",
          "code": "IC1",
          "label": "Stage IC1"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-ovarian",
          "code": "IC2",
          "label": "Stage IC2"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage-ovarian",
          "code": "IC3",
          "label": "Stage IC3"
        }
      ]
    },
    "codings-figo-2018-stage-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codings-figo-2018-stage-enum",
      "enum": [
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "0",
          "label": "Stage 0"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "I",
          "label": "Stage I"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "IA",
          "label": "Stage IA"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "IA1",
          "label": "Stage IA1"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "IA2",
          "label": "Stage IA2"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "IB",
          "label": "Stage IB"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "IB1",
          "label": "Stage IB1"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "IB2",
          "label": "Stage IB2"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "IB3",
          "label": "Stage IB3"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "IC",
          "label": "Stage IC"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "IC1",
          "label": "Stage IC1"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "IC2",
          "label": "Stage IC2"
        },
        {
          "system": "http://ccdh/vs/figo-2018-stage",
          "code": "IC3",
          "label": "Stage IC3"
        }
      ]
    },
    "codings-figo-version-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codings-figo-version-enumm",
      "enum": [
        {
          "system": "http://ccdh/vs/figo-version",
          "code": "2018",
          "label": "Version 2018"
        },
        {
          "system": "http://ccdh/vs/figo-version",
          "code": "pre2018",
          "label": "Version pre2018"
        }
      ]
    },
    "codings-staging-system-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codings-staging-system-enum",
      "enum": [
        {
          "system": "http://ccdh/vs/staging-system",
          "code": "AJCC",
          "label": "AJCC Staging System"
        },
        {
          "system": "http://ccdh/vs/staging-system",
          "code": "FIGO",
          "label": "FIGO Staging System"
        }
      ]
    },
    "codings-stageable-condition-enum": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/codings-stageable-condition-enum",
      "enum": [
        {
          "system": "http://ccdh/vs/stageable-condition",
          "code": "cancer",
          "label": "Cancer Condition"
        }
      ]
    },
    "structures": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "http://ccdh/json/schema/structures",
      "$defs": {
        "BodySite": {
          "additionalProperties": false,
          "description": "A site in the body of an organism, typically described in terms of an anatomical location and optional qualifiers (e.g. left/right, upper/lower). But body sites as defined here may include 'non-anatomic' sites, such as the location of an implanted medical device.",
          "properties": {
            "qualifier": {
              "description": "A qualifier that further refines or specifies the location of the body site (e.g. to indicate laterality, upper v. lower, containment, etc).",
              "items": {
                "$ref": "#/$defs/CodeableConcept"
              },
              "type": "array"
            },
            "site": {
              "description": "A term describing any site in the body.",
              "$ref": "#/$defs/CodeableConcept"
            }
          },
          "required": [
            "site"
          ],
          "title": "BodySite",
          "type": "object"
        },
        "CodeableConcept": {
          "additionalProperties": false,
          "description": "A representation of a concept that may be defined by or mapped to one or more codes in code systems (terminologies, ontologies, dictionaries, code sets, etc) - but may also be defined by the provision of text.",
          "properties": {
            "coding": {
              "description": "A reference to a code defined by a terminology system",
              "items": {
                "$ref": "#/$defs/Coding"
              },
              "type": "array"
            },
            "text": {
              "description": "A human language representation of the concept represented by the Coding.",
              "type": "string"
            }
          },
          "required": [],
          "title": "CodeableConcept",
          "type": "object"
        },
        "Coding": {
          "additionalProperties": false,
          "description": "A structured representation of a coded/enumerated data value, that includes additional metadata about the code and code system.",
          "properties": {
            "code": {
              "description": "The symbol/value of the code, as defined by the code system.",
              "type": "string"
            },
            "label": {
              "description": "A human-readable name for the code, as defined by the code system.",
              "type": "string"
            },
            "system": {
              "description": "The code system where the code is defined.",
              "type": "string"
            },
            "systemURL": {
              "description": "A URL where the code system can be found.",
              "type": "string"
            },
            "systemVersion": {
              "description": "The version of the code system.",
              "type": "string"
            }
          }
        },
        "Diagnosis": {
          "additionalProperties": false,
          "description": "A collection of characteristics that describe an abnormal condition of the body as assessed at a point in time. May be used to capture information about neoplastic and non-neoplastic conditions.",
          "properties": {
            "$schema": {
              "type": "string"
            },
            "condition": {
              "description": "Code that captures the condition being diagnosed (e.g. ICD-O, ICD-10, SNOMED, etc.)",
              "$ref": "#/$defs/CodeableConcept"
            },
            "disease_status": {
              "description": "A term that refers to the nature and/or clinical outcome of a disease (e.g., primary disease, metastatic disease, recurrent disease, etc.)",
              "$ref": "#/$defs/CodeableConcept"
            },
            "id": {
              "description": "The 'logical' identifier of the entity within the system of record.  The simple value of this attribute stands for an identifier of this data object within the system, it can be used as a reference from other objects within the same system (i.e. primary and foreign keys), and it should be unique per type of object. The same data object copied to a different system will likely have a different \"id\" in the new system since \"id\" values are system specific and do not represent persistent business identifiers. Business identifiers are assigned outside the information system and are captured in the \"identifier\" field. The \"id\" field is more likely to be a serially or randomly generated value that is assigned to the data object as it is created in a system.",
              "type": "string"
            },
            "metastatic_site": {
              "description": "The anatomical location(s) of metastatic disease",
              "items": {
                "$ref": "#/$defs/BodySite"
              },
              "type": "array"
            },
            "method_of_diagnosis": {
              "description": "The method used to confirm the patients malignant diagnosis",
              "$ref": "#/$defs/CodeableConcept"
            },
            "morphology": {
              "description": "Code that represents the histology of the disease using the third edition of the International Classification of Diseases for Oncology, published in 2000, used principally in tumor and cancer registries for coding the site (topography) and the histology (morphology) of neoplasms.",
              "$ref": "#/$defs/CodeableConcept"
            },
            "primary_site": {
              "description": "The anatomical location of the primary condition",
              "items": {
                "$ref": "#/$defs/BodySite"
              },
              "type": "array"
            },
            "stage": {
              "description": "The extent of a cancer in the body. Staging is usually based on the size of the tumor, whether lymph nodes contain cancer, and whether the cancer has spread from the original site to other parts of the body.",
              "items": {
                "$ref": "#/$defs/ObservationSet"
              },
              "type": "array"
            }
          },
          "required": [],
          "title": "Diagnosis",
          "type": "object"
        },
        "Observation": {
          "additionalProperties": false,
          "description": "A structured object that describes a single data item about an entity, as generated through a point-in-time observation, measurement, or interpretation.",
          "properties": {
            "category": {
              "description": "The general category of observation described",
              "$ref": "#/$defs/CodeableConcept"
            },
            "id": {
              "description": "The 'logical' identifier of the entity within the system of record.  The simple value of this attribute stands for an identifier of this data object within the system, it can be used as a reference from other objects within the same system (i.e. primary and foreign keys), and it should be unique per type of object. The same data object copied to a different system will likely have a different \"id\" in the new system since \"id\" values are system specific and do not represent persistent business identifiers. Business identifiers are assigned outside the information system and are captured in the \"identifier\" field. The \"id\" field is more likely to be a serially or randomly generated value that is assigned to the data object as it is created in a system.",
              "type": "string"
            },
            "method_type": {
              "description": "A type of method used in generating the Observation result.",
              "items": {
                "$ref": "#/$defs/CodeableConcept"
              },
              "type": "array"
            },
            "observation_type": {
              "description": "The specific type of observation made - i.e. the feature or characteristic that was observed, measured, estimated, etc..",
              "$ref": "#/$defs/CodeableConcept"
            },
            "valueBoolean": {
              "description": "The result of the observation, encoded as a boolean.",
              "type": "boolean"
            },
            "valueCodeableConcept": {
              "description": "The result of the observation, encoded as a CodeableConcept.",
              "$ref": "#/$defs/CodeableConcept"
            },
            "valueDateTime": {
              "description": "The result of the observation, encoded as a dateTime.",
              "type": "string"
            },
            "valueDecimal": {
              "description": "The result of the observation, encoded as a decimal.",
              "type": "string"
            },
            "valueInteger": {
              "description": "The result of the observation, encoded as a decimal.",
              "type": "string"
            },
            "valueString": {
              "description": "The result of the observation, encoded as a free-text string.",
              "type": "string"
            }
          },
          "required": [
            "observation_type"
          ],
          "title": "Observation",
          "type": "object"
        },
        "ObservationSet": {
          "additionalProperties": false,
          "description": "A structured object to hold related data items about an entity, as generated through a point-in-time observation, measurement, or interpretation.",
          "properties": {
            "category": {
              "description": "The general category of observation set described",
              "$ref": "#/$defs/CodeableConcept"
            },
            "id": {
              "description": "The 'logical' identifier of the entity within the system of record.  The simple value of this attribute stands for an identifier of this data object within the system, it can be used as a reference from other objects within the same system (i.e. primary and foreign keys), and it should be unique per type of object. The same data object copied to a different system will likely have a different \"id\" in the new system since \"id\" values are system specific and do not represent persistent business identifiers. Business identifiers are assigned outside the information system and are captured in the \"identifier\" field. The \"id\" field is more likely to be a serially or randomly generated value that is assigned to the data object as it is created in a system.",
              "type": "string"
            },
            "method_type": {
              "description": "A type of method used in generating each of the Observations bundled in the set.",
              "items": {
                "$ref": "#/$defs/CodeableConcept"
              },
              "type": "array"
            },
            "observations": {
              "description": "A set of one or more more atomic observations that are conceptually or logically related - e.g. two components of some compound measurement (e.g. the systolic and diastolic components of a blood pressure measurement), or a panel of related measurements run and interpreted together on the same subject/specimen (e.g. a blood panel, or separate dimensional measurements of a specimen).",
              "items": {
                "$ref": "#/$defs/Observation"
              },
              "type": "array"
            }
          },
          "required": [
            "id",
            "category"
          ],
          "title": "ObservationSet",
          "type": "object"
        }
      }
    }
  }
}